<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title></title>
    <link rel="stylesheet" type="text/css" href="../Scripts/layui/css/layui.css" />
    <style>
        body {
            padding: 15px;
        }
    </style>
</head>
<body>
    <div class="layui-form-item">
        <div class="layui-inline">
            <button class="layui-btn" type="button" onclick="javascript:window.location.href='practiceexam.html'">
                <i class="layui-icon">&#xe603;</i>
            </button>
        </div>
    </div>

    <table class="layui-table" id="kclist" lay-filter="test"></table>
    <script type="text/html" id="statusTpl">
        {{#  if(d.IsAnswered === 1){ }}
        <span style="cursor:default" class="layui-btn layui-btn-xs layui-bg-green">已作答</span>
        {{#  }else{ }}
        <span style="cursor:default" class="layui-btn layui-btn-xs  layui-bg-red">未作答</span>
        {{# } }}
    </script>
    <script type="text/html" id="actionTpl">
        <a class="layui-btn layui-btn-xs" lay-event="look">查看试卷</a>
    </script>

    <script type="text/javascript" src="../Scripts/layui/layui.js"></script>
    <script>

        layui.use('table', function () {
            var table = layui.table;
            var $ = layui.jquery;

            var _handlers = {
                _show: function (kcGuid) {

                },
                getQueryString: function (name) {
                    var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)", "i");
                    var r = window.location.search.substr(1).match(reg);
                    if (r != null) return unescape(r[2]); return null;
                },
                _getlist: function () {
                    var id = _handlers.getQueryString("id");
                    table.render({
                        id: "kclist",
                        elem: "#kclist",
                        page: true, limit: 10,
                        url: "../tools/PracticeExamHandler.ashx?action=getkcuserlist&id=" + id,
                        cols: [[{ field: "UserName", title: "考生姓名", width: 100 }, { field: "IsAnswered", title: "是否作答", width: 100, templet: "#statusTpl" }, { field: "UserScore", title: "得分", width: 100 }, { field: "ExamGuid", title: "操作", width: 160, templet: "#actionTpl" }]]
                    })
                }
            };
            _handlers._getlist();


            table.on('tool(test)', function (obj) {
                var data = obj.data;
                var examGuid = data.ExamGuid;
                if (obj.event === "look") {
                    var layerIndex = layer.open({
                        type: 2,
                        title: data.ExamName+"-----"+ data.UserName,
                        maxmin: false,
                        content: "../Pages/papershow.html?id=" + examGuid + "&s=" + data.ExamScore + "&ds=" + data.UserScore + "&uid=" + data.UserGuid ,
                        shade: [0.8, '#393D49'],
                        success: function (index, layero) {
                        },
                        btn: ['关闭'],
                        no: function (index, layero) {
                        }
                    });
                    layer.full(layerIndex);
                }
            });

        });
    </script>

</body>
</html>
